<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<title>Iniciar Sesión</title>
</head>
<body>
	<form id="formulario">
		<input id="usuario" type="email" placeholder="Correo" required>
		<input id="contra" type="password" placeholder="Contraseña" required>
		<input id="enviar" type="submit" value="Enviar">
	</form>
	<button class="cerrar">Cerrar sesión</button>
	<section class="contenido"></section>
	<!-- Jq -->
	<script src="js/jquery-3.4.1.min.js"></script>
	<!-- Fire -->
	<script src="https://www.gstatic.com/firebasejs/5.10.1/firebase-app.js"></script>
	<!-- Auth -->
	<script src="https://www.gstatic.com/firebasejs/5.10.1/firebase-auth.js"></script>
	<!-- Mi app -->
	<script>
		//Iniciar firebase
		const firebaseConfig = {
			apiKey: "AIzaSyDZPvhThHsK7tG0kxwZ47q7XRMlE8AaZn0",
			authDomain: "projectf1834543.firebaseapp.com",
			databaseURL: "https://projectf1834543.firebaseio.com",
			projectId: "projectf1834543",
			storageBucket: "",
			messagingSenderId: "446281075829",
			appId: "1:446281075829:web:002598c4a1b1c00d"
		};
		
		// Initialize Firebase
		firebase.initializeApp(firebaseConfig);
		//Iniciar la sesión
		function iniciarSesion(){
				firebase.auth().signInWithEmailAndPassword(usuario,contra)
				.then(function(){
					console.log('Sesión activa');
				}).catch(function(error) {
					// Handle Errors here.
					let errorCode = error.code;
					let errorMessage = error.message;
					$('.contenido').html(`
						<h1>Mensaje: ${errorCode}, ${errorMessage}</h1>
					`);
				});
			}

		//Enviar los datos
		$('#enviar').click(function(e){
			let usuario  = $('#usuario').val();
			let contra = $('#contra').val();

			e.preventDefault();
			iniciarSesion();
		});

		function sesionActiva(){
			firebase.auth().onAuthStateChanged(function(user) {
				if (user) {
					let email = user.email;
					let uid = user.uid;
					let providerData = user.providerData;
					$('.contenido').html(`<h1>Bienvenido ${email}</h1>`);
				} else {
					console.log('No hay sesión activa');
				}
			});
		}

		sesionActiva();

		$('.cerrar').click( function(){
			firebase.auth().signOut().then(function(){
				console.log('Sesión finalizada');
			});
		});

	</script>
</body>
</html>